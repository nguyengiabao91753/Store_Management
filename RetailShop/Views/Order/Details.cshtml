@model RetailShop.Models.Order

@{
    ViewData["order"] = "menu-open";
    ViewData["order-list"] = "active";
}

<section class="content-header">
    <div class="container-fluid">
        @* <button class="btn btn-primary" asp-controller="Order" asp-action="Index">Back</button> *@
        <div class="row mb-2">

            <div class="col-sm-6">
                <h1>OrderID @Model.OrderId - Detail</h1>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a asp-controller="Order" asp-action="Index">Order</a></li>
                    <li class="breadcrumb-item active">Detail</li>
                </ol>
            </div>
        </div>
    </div>
</section>

<section class="content">
    <div class="container-fluid">

        <div class="card mb-4">
            <div class="card-header">
                <h5>Order Information</h5>
            </div>
            <div class="card-body">
@*                 <p><strong>Customer ID:</strong> @Model.CustomerId</p>
                <p><strong>User ID:</strong> @Model.UserId</p>
                <p><strong>Promo ID:</strong> @Model.PromoId</p> *@
                <p><strong>Order Date:</strong> @Model.OrderDate</p>
                <p><strong>Status:</strong> @Model.Status</p>
                <p><strong>Total Amount:</strong> @Model.TotalAmount</p>
                <p><strong>Discount Amount:</strong> @Model.DiscountAmount</p>
@*                 @if (Model.Payments != null)
                {
                    <div class="mt-3">
                        <p><strong>Payment Method:</strong> @Model.Payments.PaymentMethod</p>
                        <p><strong>Payment Date:</strong> @(Model.Payments.PaymentDate?.ToString("yyyy-MM-dd HH:mm") ?? "N/A")</p>
                    </div>
                } *@
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h5>Customer Information</h5>
            </div>
            <div class="card-body">
                <p><strong>Customer Name:</strong> @(Model.Customer != null ? Model.Customer.Name : "N/A")</p>
                <p><strong>Customer Email:</strong> @(Model.Customer != null ? Model.Customer.Email : "N/A")</p>
                <p><strong>Customer Phone:</strong> @(Model.Customer != null ? Model.Customer.Phone : "N/A")</p>
                <p><strong>Customer Address:</strong> @(Model.Customer != null ? Model.Customer.Address : "N/A")</p>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h5>User Information</h5>
            </div>
            <div class="card-body">
                <p><strong>Username:</strong> @(Model.User != null ? Model.User.Username : "N/A")</p>
                <p><strong>Full Name:</strong> @(Model.User != null ? Model.User.FullName : "N/A")</p>
                <p><strong>Role:</strong> @(Model.User != null ? Model.User.Role : "N/A")</p>
@*                 <p><strong>Created At:</strong> @Model.User?.CreatedAt?.ToString("yyyy-MM-dd HH:mm")</p>
                <p><strong>Status:</strong> @(Model.User != null ? (Model.User.Active ? "Active" : "Inactive") : "N/A")</p> *@
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h5>Products by this Order</h5>
            </div>
            <div class="card-body">
                <table id="orderItemTable" class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>Product ID</th>
                            <th>Image</th>
                            <th>Product Name</th>
                            <th>Category</th>
                            <th>Quantity</th>
                            <th>Price</th>
                            <th>SubTotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.OrderItems)
                        {
                            <tr>
                                <td>@item.ProductId</td>
                                <td>
                                    <img src="@item.Product?.ProductImage" alt="@item.Product?.ProductName" width="60" height="60" style="object-fit: cover;" />
                                </td>
                                <td>@item.Product?.ProductName</td>
                                <td>@item.Product?.Category?.CategoryName</td>
                                <td>@item.Quantity</td>
                                <td>@item.Price.ToString("C")</td>
                                <td>@item.Subtotal?.ToString("C")</td>

                            </tr>
                        }

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

@section jslinks {
    <script src="~/Admin/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/Admin/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script>
        $(function () {
            $('#orderItemTable').DataTable({
                "responsive": true,
                "autoWidth": false,
                "pageLength": 10
            });
        });
    </script>
}
